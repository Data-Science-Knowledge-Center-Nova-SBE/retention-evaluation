#create table atb2.alunos_inscricoes_avaliacao_singlerow as 
select 
	alunos.nProcesso,
	alunos.agrupamento,
	alunos.anoLetivo,
	alunos.ano,
	turma,
	escalao,
	nee,
	`dataNascimento a` as dataNascimento,
	genero,
	nacionalidade,
	linguaMaterna,
	anoEscMae,
	`concelho a` as concelho,
	distrito,
	transferencia,
	abandono,
	rFinal,
	estado,
	adapted_curric_flag,
	negative_class_ratio_1P,
	negative_class_ratio_nuclear_1P,
	negative_class_ratio_not_nuclear_1P,
	negative_class_ratio_2P,
	negative_class_ratio_nuclear_2P,
	negative_class_ratio_not_nuclear_2P,
	negative_class_ratio_3P,
	negative_class_ratio_nuclear_3P,
	negative_class_ratio_not_nuclear_3P,
	class1P_ingles_ling_estr,
	class2P_ingles_ling_estr,
	class3P_ingles_ling_estr,
	class1P_art_tecn,
	class2P_art_tecn,
	class1P_cienc_fis_nat,
	class2P_cienc_fis_nat,
	class1P_cienc_soc_huma,
	class2P_cienc_soc_huma,
	class1P_ed_fis,
	class2P_ed_fis,
	class1P_ingles,
	class2P_ingles,
	class1P_ling_estrang,
	class2P_ling_estrang,
	class1P_matematica,
	class2P_matematica,
	class1P_portugues,
	class2P_portugues,
	class1P_outros,
	class2P_outros,
	class3P_art_tecn,
	class3P_cienc_fis_nat,
	class3P_cienc_soc_huma,
	class3P_ed_fis,
	class3P_ingles,
	class3P_ling_estrang,
	class3P_matematica,
	class3P_portugues,
	class3P_outros
from 
	atb2.alunos_inscricoes_singlerow alunos
left join atb2.avaliacao_singlerow avaliacao
on 
	alunos.nProcesso = avaliacao.nProcesso and 
	alunos.agrupamento = avaliacao.agrupamento and 
	left(alunos.anoLetivo, 4) = avaliacao.anoLetivo_c and 
	right(alunos.ano, 1) = avaliacao.ano_c 
